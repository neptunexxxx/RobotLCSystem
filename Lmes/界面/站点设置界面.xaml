<mah:MetroWindow x:Class="Lmes.界面.站点设置界面"
      xmlns:metro="http://metro.mahapps.com/winfx/xaml/controls" 
      xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:Lmes.界面"
      xmlns:sys="clr-namespace:System;assembly=mscorlib"
      xmlns:s7="clr-namespace:S7.Net;assembly=S7.Net" xmlns:notifications="clr-namespace:Notifications.Wpf.Core.Controls;assembly=Notifications.Wpf.Core"
                 mc:Ignorable="d"
      Title="站点设置界面" Height="700" Width="900" Loaded="MetroWindow_Loaded">
    <d:MetroWindow.DataContext>
        <local:站点设置界面/>
    </d:MetroWindow.DataContext>
    <Window.Resources>
        <ObjectDataProvider x:Key="DataTypeEnumDataSource"
                    ObjectType="{x:Type sys:Enum}"
                    MethodName="GetValues">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="s7:DataType" />
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
        <ObjectDataProvider x:Key="VarTypeEnumDataSource"
            ObjectType="{x:Type sys:Enum}"
            MethodName="GetValues">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="s7:VarType" />
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
        <ObjectDataProvider x:Key="CpuTypeEnumDataSource"
     ObjectType="{x:Type sys:Enum}"
     MethodName="GetValues">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="s7:CpuType" />
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
    </Window.Resources>
    <DockPanel>
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="打开" Height="30" Click="MenuItem_打开_Click"/>
            <MenuItem Header="另存为" Height="30" Click="MenuItem_另存为_Click"/>
            <MenuItem Header="生成默认模版" Height="30" x:Name="生成默认模版菜单" >
            </MenuItem>
        </Menu>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="3*"/>
                <RowDefinition Height="5*"/>
                <RowDefinition Height="1*"/>
            </Grid.RowDefinitions>

            <GroupBox Header="参数设置">
                <ScrollViewer>
                    <StackPanel>
                        <Label Content="工站设置" FontSize="20"/>
                        <Grid Height="1" Margin="3" Background="Black"/>
                        <StackPanel Orientation="Horizontal">
                            <Label Content="工位编号" Width="60"/>
                            <TextBox Width="100" Text="{Binding 当前工位信息.工位编号}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <Label Content="工站类别" Width="60"/>
                            <ComboBox ItemsSource="{Binding 下拉框_工站类别}" Width="100"  SelectedItem="{Binding 当前工位信息.工位类型}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <Label Content="工位号" Width="60"/>
                            <TextBox Width="100" Text="{Binding 当前工位信息.工位号}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <Label Content="设备编码" Width="60"/>
                            <TextBox Width="200" Text="{Binding 当前工位信息.设备编码}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <Label Content="IOT上传Token" Width="100"/>
                            <TextBox Width="200" Text="{Binding 当前工位信息.IOT上传Token}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <Label Content="工号" Width="60"/>
                            <TextBox Width="100" Text="{Binding 当前工位信息.工号}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,5,0,5">
                            <Label Content="是否需要参数上传" Width="120"/>
                            <CheckBox VerticalAlignment="Center" IsChecked="{Binding 当前工位信息.是否需要上传参数}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                            <Label Content="是否需要物料绑定" Width="120"/>
                            <CheckBox VerticalAlignment="Center" IsChecked="{Binding 当前工位信息.是否需要绑定物料}"/>
                        </StackPanel>
                        <Label Content="PLC设置" FontSize="20" Margin="0,15,0,0"/>
                        <Grid Height="1" Margin="3" Background="Black"/>
                        <StackPanel Orientation="Horizontal">
                            <Label  Content="CPU类型" Width="60"/>
                            <ComboBox  Width="100" ItemsSource="{Binding Source={StaticResource CpuTypeEnumDataSource}}" Text="{Binding 当前工位信息.PLC连接设置.CPU类型}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <Label  Content="ip" Width="60"/>
                            <TextBox  Width="100" Text="{Binding 当前工位信息.PLC连接设置.IP地址}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <Label  Content="端口" Width="60"/>
                            <TextBox Width="100" Text="{Binding 当前工位信息.PLC连接设置.端口}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <Label  Content="机架" Width="60"/>
                            <TextBox Width="100" Text="{Binding 当前工位信息.PLC连接设置.机架}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <Label  Content="槽位" Width="60"/>
                            <TextBox Width="100" Text="{Binding 当前工位信息.PLC连接设置.槽位}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <Label  Content="采集间隔" Width="60" />
                            <TextBox Width="100" Text="{Binding 当前工位信息.PLC连接设置.采集间隔}"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </GroupBox>
            <GroupBox Grid.Row="1" Header="信号列表">
                <DataGrid  AutoGenerateColumns="False" ItemsSource="{Binding 当前工位信息.信号连接表}" CanUserAddRows="False" Name="信号列表">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="信号名称" Binding="{Binding 信号名称}"/>
                        <DataGridTextColumn Header="参数编码" Binding="{Binding 参数编码}"/>
                        <DataGridTextColumn Header="上限值" Binding="{Binding 上限值}"/>
                        <DataGridTextColumn Header="下限值" Binding="{Binding 下限值}"/>
                        <DataGridTextColumn Header="物料编码类型" Binding="{Binding 物料编码}"/>
                        <DataGridComboBoxColumn Header="数据类型" 
                                    ItemsSource="{Binding Source={StaticResource DataTypeEnumDataSource}}"
                                    SelectedItemBinding="{Binding 信号地址.DataType}"/>
                        <DataGridTextColumn Header="数据块" Binding="{Binding 信号地址.DB}"/>

                        <DataGridTextColumn Header="地址" Binding="{Binding 信号地址.StartByteAdr}"/>
                        <DataGridComboBoxColumn ItemsSource="{Binding Source={StaticResource VarTypeEnumDataSource}}" 
                                    Header="变量类型" SelectedItemBinding="{Binding 信号地址.VarType}"/>


                        <DataGridTextColumn Header="读取数量" Binding="{Binding 信号地址.Count}"/>
                        <DataGridTextColumn Header="bit起始位" Binding="{Binding 信号地址.BitAdr}"/>
                    </DataGrid.Columns>
                    <DataGrid.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="删除" Click="MenuItem_删除_Click"/>
                            <MenuItem Header="添加" Click="MenuItem_添加_Click"/>
                        </ContextMenu>
                    </DataGrid.ContextMenu>
                </DataGrid>
            </GroupBox>
            <StackPanel Orientation="Horizontal" Grid.Row="2" HorizontalAlignment="Left">
                <Label Content="偏移量" VerticalAlignment="Center"/>
                <TextBox Text="{Binding 偏移量}" MinWidth="50" VerticalAlignment="Center"/>
                <Button Content="增加" Margin="5" Click="Button_一键增加_Click" />
                <Label Content="DB块" VerticalAlignment="Center"/>
                <TextBox Text="{Binding DB块}" MinWidth="50" VerticalAlignment="Center"/>
                <Button Content="设置" Margin="5" Click="Button_一键设置_Click" />
            </StackPanel>
            <StackPanel Orientation="Horizontal" Grid.Row="2" HorizontalAlignment="Right" >
                <Button Content="取消" Margin="5" Click="Button_取消_Click"/>
                <Button Content="保存" Margin="5" Click="Button_保存_Click"/>
            </StackPanel>
            <notifications:NotificationArea  
MaxItems="3" x:Name="Area"
Position="TopRight" Grid.ColumnSpan="10" Grid.RowSpan="10" />
        </Grid>
    </DockPanel>
</mah:MetroWindow>
